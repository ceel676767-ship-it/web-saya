<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy New Year 2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --sky-deep: #010413;
            --accent: #818cf8;
            --accent-bright: #c7d2fe;
            --gold: #fbbf24;
            --glass-bg: rgba(15, 23, 42, 0.8);
            --glass-border: rgba(255, 255, 255, 0.1);
        }
        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            overflow: hidden; font-family: 'Poppins', sans-serif;
            background-color: var(--sky-deep); color: #f8fafc;
        }
        canvas { position: absolute; top: 0; left: 0; display: block; }
        #starsCanvas { z-index: 1; }
        #fwCanvas { z-index: 2; pointer-events: none; }
        .overlay {
            position: relative; z-index: 10; height: 100vh;
            display: flex; justify-content: center; align-items: center;
        }
        .container {
            background: var(--glass-bg);
            padding: 40px; border-radius: 32px;
            width: 90%; max-width: 420px;
            text-align: center; border: 1px solid var(--glass-border);
            backdrop-filter: blur(20px);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8);
            animation: floatIn 1.2s cubic-bezier(0.16, 1, 0.3, 1);
        }
        @keyframes floatIn {
            from { opacity: 0; transform: translateY(30px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        h1 {
            font-size: 2.2rem; font-weight: 700; margin-bottom: 10px;
            background: linear-gradient(to bottom right, #fff, var(--accent));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        p.subtitle { color: #94a3b8; font-size: 0.95rem; margin-bottom: 30px; }
        input, select {
            width: 100%; padding: 16px; margin-bottom: 15px; border-radius: 14px;
            background: rgba(0, 0, 0, 0.4); border: 1px solid var(--glass-border);
            color: white; font-size: 1rem; outline: none; transition: 0.3s;
            box-sizing: border-box;
        }
        .btn-main {
            width: 100%; padding: 16px; border-radius: 14px; border: none;
            background: linear-gradient(135deg, #6366f1, #4f46e5);
            color: white; font-weight: 600; font-size: 1rem; cursor: pointer;
            transition: 0.3s; box-shadow: 0 10px 15px -3px rgba(79, 70, 229, 0.3);
        }
        .modal-start {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--sky-deep); z-index: 1000;
            display: flex; justify-content: center; align-items: center;
            transition: 0.8s ease-in-out;
        }
        .modal-start.hidden { opacity: 0; visibility: hidden; pointer-events: none; }
        .icon-circle {
            width: 80px; height: 80px; background: rgba(129, 140, 248, 0.1);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            margin: 0 auto 20px; font-size: 40px; border: 1px solid rgba(129, 140, 248, 0.2);
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(129, 140, 248, 0.4); }
            70% { transform: scale(1.05); box-shadow: 0 0 0 15px rgba(129, 140, 248, 0); }
            100% { transform: scale(1); }
        }
        .gift-box {
            font-size: 150px; cursor: pointer; filter: drop-shadow(0 0 30px rgba(251, 191, 36, 0.4));
            transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .doa-card {
            max-width: 500px !important;
            padding: 50px 30px !important;
            border: 1px solid rgba(255, 251, 235, 0.2) !important;
            background: linear-gradient(145deg, rgba(15, 23, 42, 0.9), rgba(30, 41, 59, 0.8)) !important;
        }
        .doa-icon { font-size: 50px; margin-bottom: 20px; display: block; }
        .doa-content {
            font-size: 1.2rem; line-height: 1.8; color: #e2e8f0;
            font-weight: 300; letter-spacing: 0.5px;
            animation: fadeInText 2s ease;
        }
        @keyframes fadeInText { from { opacity: 0; } to { opacity: 1; } }
        .hidden { display: none !important; }

        /* Style Khusus Countdown */
        #countdownOverlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #010413; z-index: 9999;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            text-align: center; color: white; transition: opacity 0.8s ease;
        }
    </style>
</head>
<body>

    <div id="countdownOverlay">
        <div class="icon-circle" style="font-size: 50px;">‚è≥</div>
        <h1 id="countdownTitle">Sinkronisasi Waktu...</h1>
        <p id="timerDisplay" style="font-size: 2rem; font-weight: 700; color: #fbbf24; margin: 15px 0; letter-spacing: 2px;"></p>
        <p id="timerSubtitle" class="subtitle" style="padding: 0 20px;">Menghubungkan ke server waktu dunia...</p>
    </div>

    <audio id="myAudio" src="sans.MP3" preload="auto"></audio>

    <canvas id="starsCanvas"></canvas>
    <canvas id="fwCanvas"></canvas>

    <div id="startModal" class="modal-start">
        <div class="modal-card" style="text-align:center;">
            <div class="icon-circle">‚ú®</div>
            <h1>Siap Merayakan?</h1>
            <p class="subtitle">Gunakan layar <b>Landscape</b> untuk pengalaman visual kembang api yang maksimal.</p>
            <button class="btn-main" onclick="closeStartModal()">Masuk Sekarang</button>
        </div>
    </div>

    <div id="step1" class="overlay hidden">
        <div class="container">
            <h1>New Year 2026</h1>
            <p class="subtitle">Tuliskan namamu dan pilih agamamu.</p>
            <input type="text" id="nama" placeholder="Siapa namamu?">
            <select id="agama">
                <option value="">Apa Agamamu</option>
                <option value="Islam">Islam</option>
                <option value="Kristen">Kristen / Katolik</option>
                <option value="Hindu">Hindu</option>
                <option value="Buddha">Buddha</option>
                <option value="Khonghucu">Khonghucu</option>
                <option value="Umum">Umum / Lainnya</option>
            </select>
            <button class="btn-main" onclick="toStep2()">Lanjutkan</button>
        </div>
    </div>

    <div id="step2" class="overlay hidden">
        <div style="text-align:center">
            <div class="gift-box" onclick="startFireworksSequence()">üéÅ</div>
            <p style="letter-spacing: 5px; font-weight: 300; margin-top: 20px; opacity: 0.8; color: white;">KETUK UNTUK MEMBUKA</p>
        </div>
    </div>

    <div id="step3" class="overlay hidden">
        <div class="container doa-card">
            <span class="doa-icon">üåå</span>
            <h1 id="greeting" style="font-size: 1.8rem; margin-bottom: 20px;"></h1>
            <div style="width: 40px; height: 2px; background: var(--gold); margin: 0 auto 25px; opacity: 0.6;"></div>
            <p id="doa-text" class="doa-content"></p>
            <button class="btn-main" style="width: auto; padding: 12px 50px; margin-top: 40px; border-radius: 50px;" onclick="location.reload()">Kembali</button>
        </div>
    </div>

<script>
    // --- LOGIKA PENGUNCI WAKTU ANTI-CHEAT (SERVER BASED) ---
    async function checkTime() {
        const targetDate = new Date('December 31, 2025 23:59:30').getTime();
        const timerDisplay = document.getElementById('timerDisplay');
        const countdownTitle = document.getElementById('countdownTitle');
        const timerSubtitle = document.getElementById('timerSubtitle');
        const overlay = document.getElementById('countdownOverlay');

        async function fetchServerTime() {
            try {
                // Mengambil waktu dari WorldTimeAPI (Jakarta)
                const response = await fetch('https://worldtimeapi.org/api/timezone/Asia/Jakarta');
                const data = await response.json();
                let nowServer = new Date(data.datetime).getTime();

                countdownTitle.innerText = "Belum Waktunya...";
                timerSubtitle.innerHTML = "Halaman ini akan terbuka otomatis pada <br><b>1 Januari 2026 pukul 00:00</b>";

                const timerInt = setInterval(() => {
                    const distance = targetDate - nowServer;

                    if (distance > 0) {
                        const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                        const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                        const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                        const seconds = Math.floor((distance % (1000 * 60)) / 1000);
                        
                        timerDisplay.innerHTML = `${days}d ${hours}h ${minutes}m ${seconds}s`;
                        nowServer += 1000; // Increment waktu server secara manual tiap detik
                    } else {
                        clearInterval(timerInt);
                        overlay.style.opacity = '0';
                        setTimeout(() => { overlay.style.display = 'none'; }, 800);
                    }
                }, 1000);

            } catch (err) {
                console.log("Retrying API...");
                setTimeout(fetchServerTime, 2000);
            }
        }
        fetchServerTime();
    }
    checkTime();
    // ----------------------------------------------------

    const sCanvas = document.getElementById('starsCanvas');
    const fCanvas = document.getElementById('fwCanvas');
    const sCtx = sCanvas.getContext('2d');
    const fCtx = fCanvas.getContext('2d', { alpha: true });

    let rockets = [];
    let particles = [];
    let stars = [];
    let buildings = [];
    const neonColors = ['#00f2ff', '#00ff8c', '#ff007a', '#ffcf00', '#bc00ff', '#ffffff', '#818cf8'];

    function playSingleSound(volume = 0.4) {
        const audio = document.getElementById('myAudio');
        if (audio) {
            const soundClone = audio.cloneNode();
            soundClone.volume = volume;
            soundClone.loop = false;
            soundClone.play().catch(e => {});
            soundClone.onended = () => soundClone.remove();
        }
    }

    function setup() {
        sCanvas.width = fCanvas.width = window.innerWidth;
        sCanvas.height = fCanvas.height = window.innerHeight;
        initStars();
        initBuildings();
    }

    function initStars() {
        stars = [];
        for (let i = 0; i < window.innerWidth / 1.2; i++) {
            stars.push({
                x: Math.random() * sCanvas.width,
                y: Math.random() * sCanvas.height,
                size: Math.random() * 1.8,
                opacity: Math.random(),
                speed: Math.random() * 0.01 + 0.005,
                color: Math.random() > 0.8 ? '#818cf8' : '#ffffff'
            });
        }
    }

    function initBuildings() {
        buildings = [];
        const bWidthBase = 80;
        const bCount = Math.ceil(sCanvas.width / bWidthBase);
        for (let i = 0; i < bCount; i++) {
            const h = Math.random() * (sCanvas.height * 0.3) + 120;
            const w = bWidthBase + Math.random() * 50;
            const x = i * (sCanvas.width / bCount);
            let windowGrid = [];
            const rows = Math.floor(h / 18);
            const cols = Math.floor(w / 14);
            for(let r=0; r<rows; r++) {
                for(let c=0; c<cols; c++) {
                    windowGrid.push({
                        relX: (c * 14) + 8,
                        relY: (r * 18) + 15,
                        on: Math.random() > 0.5,
                        color: Math.random() > 0.9 ? '#ef4444' : (Math.random() > 0.2 ? '#fcd34d' : '#ffffff')
                    });
                }
            }
            buildings.push({ x, width: w, height: h, windowGrid });
        }
    }

    function drawStars() {
        const skyGrad = sCtx.createLinearGradient(0, 0, 0, sCanvas.height);
        skyGrad.addColorStop(0, '#020617');
        skyGrad.addColorStop(1, '#0f172a');
        sCtx.fillStyle = skyGrad;
        sCtx.fillRect(0, 0, sCanvas.width, sCanvas.height);
        stars.forEach(s => {
            s.opacity += s.speed;
            if (s.opacity > 1 || s.opacity < 0.2) s.speed = -s.speed;
            sCtx.globalAlpha = s.opacity;
            sCtx.fillStyle = s.color;
            sCtx.beginPath();
            sCtx.arc(s.x, s.y, s.size, 0, Math.PI * 2);
            sCtx.fill();
        });
        sCtx.globalAlpha = 1;
        requestAnimationFrame(drawStars);
    }

    function drawBuildingsLayer(ctx) {
        buildings.forEach(b => {
            const buildingTop = ctx.canvas.height - b.height;
            const bGrad = ctx.createLinearGradient(b.x, buildingTop, b.x, ctx.canvas.height);
            bGrad.addColorStop(0, '#1e293b'); 
            bGrad.addColorStop(1, '#0f172a'); 
            ctx.fillStyle = bGrad;
            ctx.fillRect(b.x, buildingTop, b.width, b.height);
            b.windowGrid.forEach(w => {
                const wx = b.x + w.relX;
                const wy = buildingTop + w.relY;
                if (w.on) {
                    ctx.fillStyle = w.color;
                    ctx.globalAlpha = 0.6; 
                    ctx.fillRect(wx, wy, 6, 8);
                }
            });
            ctx.globalAlpha = 1;
        });
    }

    function closeStartModal() {
        document.getElementById('startModal').classList.add('hidden');
        setTimeout(() => { document.getElementById('step1').classList.remove('hidden'); }, 500);
    }

    function toStep2() {
        if(!document.getElementById('nama').value || !document.getElementById('agama').value) return alert("Lengkapi data dulu ya!");
        document.getElementById('step1').classList.add('hidden');
        document.getElementById('step2').classList.remove('hidden');
    }

    class Rocket {
        constructor(x, targetY, isBig = false) {
            this.x = x; 
            this.y = fCanvas.height; 
            this.targetY = targetY;
            this.isBig = isBig;
            this.color = neonColors[Math.floor(Math.random() * neonColors.length)];
            this.vy = isBig ? -17 : -(Math.random() * 6 + 10);
            this.vx = Math.random() * 2 - 1;
            this.dead = false;
            this.trail = []; 
            this.maxTrail = 25;
        }

        update() {
            this.trail.push({ x: this.x, y: this.y });
            if (this.trail.length > this.maxTrail) this.trail.shift();
            this.x += this.vx; 
            this.y += this.vy;
            this.vy += 0.05;

            if (this.vy >= 0 || this.y <= this.targetY) { 
                this.dead = true; 
                this.explode(); 
            }
        }

        explode() {
            playSingleSound(this.isBig ? 0.9 : 0.3);
            if (this.isBig) {
                this.explodeText("HAPPY NEW YEAR 2026");
            } else {
                const shapeType = Math.floor(Math.random() * 3);
                const pCount = 150;
                for(let i = 0; i < pCount; i++) {
                    const angle = (i / pCount) * Math.PI * 2;
                    let vx, vy;
                    if (shapeType === 1) { // Heart
                        const t = angle;
                        vx = 16 * Math.pow(Math.sin(t), 3);
                        vy = -(13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t));
                        const s = Math.random() * 0.4 + 0.2;
                        vx *= s; vy *= s;
                    } else if (shapeType === 2) { // Star
                        const t = angle;
                        const r = 5 * (Math.cos(5 * t) + 1.5);
                        vx = r * Math.cos(t) * (Math.random() * 0.5 + 0.5);
                        vy = r * Math.sin(t) * (Math.random() * 0.5 + 0.5);
                    } else { // Circle
                        const speed = Math.random() * 7 + 3;
                        vx = Math.cos(angle) * speed;
                        vy = Math.sin(angle) * speed;
                    }
                    particles.push(new Particle(this.x, this.y, this.color, vx, vy));
                }
            }
        }

        explodeText(text) {
            const fontSize = 80; 
            const tempCanvas = document.createElement('canvas');
            const tempCtx = tempCanvas.getContext('2d');
            tempCanvas.width = fCanvas.width;
            tempCanvas.height = fCanvas.height;
            tempCtx.font = `bold ${fontSize}px Arial`;
            tempCtx.textAlign = "center";
            tempCtx.textBaseline = "middle";
            tempCtx.fillText(text, this.x, this.y);
            const imageData = tempCtx.getImageData(0, 0, fCanvas.width, fCanvas.height).data;
            for (let y = 0; y < fCanvas.height; y += 6) { 
                for (let x = 0; x < fCanvas.width; x += 6) {
                    const index = (y * fCanvas.width + x) * 4;
                    if (imageData[index + 3] > 128) {
                        const color = Math.random() > 0.5 ? "#FFD700" : "#FFFFFF";
                        const vX = (Math.random() - 0.5) * 0.5;
                        const vY = (Math.random() - 0.5) * 0.5;
                        particles.push(new Particle(x, y, color, vX, vY, true));
                    }
                }
            }
        }

        draw() {
            for (let i = 0; i < this.trail.length; i++) {
                const p = this.trail[i];
                const opacity = i / this.trail.length;
                const size = opacity * (this.isBig ? 4 : 2.5);
                fCtx.beginPath();
                fCtx.fillStyle = this.color;
                fCtx.globalAlpha = opacity * 0.4;
                fCtx.arc(p.x, p.y, size, 0, Math.PI * 2);
                fCtx.fill();
            }
            fCtx.globalAlpha = 1;
            fCtx.fillStyle = "#ffffff";
            fCtx.beginPath();
            fCtx.arc(this.x, this.y, this.isBig ? 5 : 3, 0, Math.PI * 2);
            fCtx.fill();
        }
    }

    class Particle {
        constructor(x, y, color, vx, vy, isText = false) {
            this.x = x; this.y = y; this.color = color;
            this.vx = vx; this.vy = vy; 
            this.alpha = 1.0;
            this.friction = 0.98;
            this.gravity = isText ? 0.005 : 0.04; 
            this.decay = isText ? 0.005 : 0.015; 
        }
        update() {
            this.vx *= this.friction;
            this.vy *= this.friction;
            this.vy += this.gravity;
            this.x += this.vx; 
            this.y += this.vy;
            this.alpha -= this.decay;
        }
        draw() {
            fCtx.save();
            fCtx.globalAlpha = this.alpha;
            fCtx.fillStyle = this.color;
            fCtx.beginPath(); fCtx.arc(this.x, this.y, 2.2, 0, Math.PI * 2); fCtx.fill();
            fCtx.restore();
        }
    }

    function animate() {
        fCtx.clearRect(0, 0, fCanvas.width, fCanvas.height);
        fCtx.fillStyle = 'rgba(1, 4, 19, 0.1)';
        fCtx.fillRect(0, 0, fCanvas.width, fCanvas.height);
        rockets.forEach((r, i) => { 
            r.update(); r.draw(); 
            if(r.dead) rockets.splice(i,1); 
        });
        drawBuildingsLayer(fCtx);
        particles.forEach((p, i) => { 
            p.update(); p.draw(); 
            if(p.alpha <= 0) particles.splice(i,1); 
        });
        requestAnimationFrame(animate);
    }

    function startFireworksSequence() {
        const mainAudio = document.getElementById('myAudio');
        if (mainAudio) {
            mainAudio.currentTime = 0;
            mainAudio.play().catch(e => {});
        }
        document.getElementById('step2').classList.add('hidden');
        animate();
        let count = 0;
        const interval = setInterval(() => {
            rockets.push(new Rocket(Math.random() * fCanvas.width, Math.random() * (fCanvas.height/2)));
            if(++count >= 80) {
                clearInterval(interval);
                setTimeout(() => {
                    rockets.push(new Rocket(fCanvas.width/2, fCanvas.height * 0.5, true));
                    setTimeout(showDoa, 7000); 
                }, 1500);
            }
        }, 400); 
    }

    function showDoa() {
        document.getElementById('step3').classList.remove('hidden');
        const nama = document.getElementById('nama').value;
        const agama = document.getElementById('agama').value;
        document.getElementById('greeting').innerText = `Happy New Year 2026, ${nama}!`;
        const doas = {
            "Islam": "Semoga Allah SWT melimpahkan berkah, kesehatan, dan kebahagiaan untukmu di tahun 2026.",
            "Kristen": "Semoga kasih Tuhan senantiasa menyertai dan memberkati setiap langkahmu di tahun baru ini.",
            "Hindu": "Semoga Ida Sang Hyang Widhi Wasa memberikan sinar suci dan kebahagiaan melimpah.",
            "Buddha": "Semoga Anda senantiasa diliputi cinta kasih dan ketenangan batin di tahun yang baru.",
            "Khonghucu": "Semoga kebajikan menyertai dan memberkati setiap usaha Anda dengan kesuksesan.",
            "Umum": "Semoga tahun 2026 menjadi tahun yang luar biasa, penuh kejutan manis, dan pencapaian hebat!"
        };
        document.getElementById('doa-text').innerText = doas[agama] || doas["Umum"];
    }

    window.addEventListener('resize', setup);
    setup();
    drawStars();
</script>
</body>
</html>
